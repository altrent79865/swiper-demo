<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Swiper Navigation</title>
    <!-- user-scalable=no added because a double tap on arrows was zooming screen and getting it stuck where it wouldn't zoom back.  Also, I don't believe swiper supports user zoom -->
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1, user-scalable=no"
    />
    <!-- Link Swiper's CSS -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css"
    />
    <link rel="stylesheet" href="../css/index.css" />
  </head>
  <body>
    <!-- Swiper -->
    <div class="swiper mySwiper">
      <div class="swiper-wrapper">
        <!-- Crawfish Link -->
        <div class="swiper-slide">
          <div class="link-main-page-container">
            <div class="image-container-for-portraits-desktop-link">
              <img src="../assets/crawfish-etouffee.jpg" class="link-img" />
            </div>
            <div class="link-container">
              <p class="link-title">Drago's Charbroiled Oyster Recipe</p>
              <p class="link-description">
                This authentic recipe for charbroiled oysters was developed by
                Tommy Cicero of Drago's Restaurant in New Orleans and Metarie,
                Louisiana.
              </p>
              <p class="link-clickable-text-wrapper">
                <a
                  href="https://www.saveur.com"
                  rel="noopener noreferrer"
                  class="link-clickable-text"
                  >SAVEUR.COM</a
                >
              </p>
              <a
                href="https://www.saveur.com"
                class="grey_button"
                rel="noopener noreferrer"
              >
                <img
                  src="../assets/jump_link_white.png"
                  alt="icon"
                  class="button-icon"
                />
                <span>Open Link</span>
              </a>
            </div>
          </div>
          <div class="title-row">
            <a href="../index.html" class="close-btn">
              <span class="x-line"></span>
            </a>
            <div class="pencil-title-row non-interactive">
              <p class="media-item-title">Crawfish Etouffee</p>
            </div>
            <a href="" class="options-btn">
              <span class="dot"></span>
              <span class="dot"></span>
              <span class="dot"></span>
            </a>
          </div>
          <div class="title-row-bottom">
            <div class="number-of-items-btn">
              <span class="number-of-items-text">38/47</span>
            </div>
          </div>
        </div>
        <!-- Little Guy (portrait) -->
        <div class="swiper-slide">
          <div class="image-container-for-portraits-desktop">
            <img src="../assets/leo-portrait.jpg" class="portrait-img" />
          </div>
          <div class="title-row">
            <a href="../index.html" class="close-btn"
              ><span class="x-line"></span
            ></a>
            <div class="pencil-title-row non-interactive">
              <p class="media-item-title">Little Guy</p>
            </div>
            <a href="" class="options-btn">
              <span class="dot"></span>
              <span class="dot"></span>
              <span class="dot"></span>
            </a>
          </div>
          <div class="title-row-bottom">
            <div class="number-of-items-btn">
              <span class="number-of-items-text">39/47</span>
            </div>
          </div>
        </div>
        <!-- Christmas Meal slide (portrait) -->
        <div class="swiper-slide">
          <div class="image-container-for-portraits-desktop">
            <img src="../assets/christmas-meal.jpg" class="portrait-img" />
          </div>
          <div class="title-row">
            <a href="../index.html" class="close-btn"
              ><span class="x-line"></span
            ></a>
            <div class="pencil-title-row non-interactive">
              <!-- <img src="../assets/pencil-white.png" class="pencil" alt="" /> -->
              <p class="media-item-title">Christmas Dinner Table Setting...</p>
            </div>
            <a href="" class="options-btn">
              <span class="dot"></span>
              <span class="dot"></span>
              <span class="dot"></span>
            </a>
          </div>
          <div class="title-row-bottom">
            <div class="number-of-items-btn">
              <span class="number-of-items-text">40/47</span>
            </div>
          </div>
        </div>
        <!-- Italian Roots (portrait) -->
        <div class="swiper-slide">
          <div class="image-container-for-portraits-desktop">
            <img src="../assets/leo-portrait2.jpg" class="portrait-img" />
          </div>
          <div class="title-row">
            <a href="../index.html" class="close-btn"
              ><span class="x-line"></span
            ></a>
            <div class="pencil-title-row non-interactive">
              <p class="media-item-title">Italian Roots</p>
            </div>
            <a href="" class="options-btn">
              <span class="dot"></span>
              <span class="dot"></span>
              <span class="dot"></span>
            </a>
          </div>
          <div class="title-row-bottom">
            <div class="number-of-items-btn">
              <span class="number-of-items-text">41/47</span>
            </div>
          </div>
        </div>
        <!-- Pork with Rosemary with Pencil Icon and Add a Caption feature (portrait) -->
        <div class="swiper-slide">
          <div class="image-container-for-portraits-desktop">
            <img src="../assets/meat-portrait.jpg" class="portrait-img" />
          </div>
          <div class="title-row">
            <a href="../index.html" class="close-btn"
              ><span class="x-line"></span
            ></a>
            <div class="pencil-title-row">
              <div class="pencil-container">
                <img src="../assets/pencil-white.png" class="pencil" alt="" />
              </div>
              <p class="media-item-title add-new-caption">Add a Caption</p>
            </div>
            <a href="" class="options-btn">
              <span class="dot"></span>
              <span class="dot"></span>
              <span class="dot"></span>
            </a>
          </div>
          <div class="title-row-bottom">
            <div class="number-of-items-btn">
              <span class="number-of-items-text">42/47</span>
            </div>
          </div>
        </div>
        <!-- Christmas Meal slide (portrait) -->
        <div class="swiper-slide">
          <div class="image-container-for-portraits-desktop">
            <img src="../assets/christmas-meal.jpg" class="portrait-img" />
          </div>
          <div class="title-row">
            <a href="../index.html" class="close-btn"
              ><span class="x-line"></span
            ></a>
            <div class="pencil-title-row non-interactive">
              <!-- <img src="../assets/pencil-white.png" class="pencil" alt="" /> -->
              <p class="media-item-title">Christmas Dinner Table Setting...</p>
            </div>
            <a href="" class="options-btn">
              <span class="dot"></span>
              <span class="dot"></span>
              <span class="dot"></span>
            </a>
          </div>
          <div class="title-row-bottom">
            <div class="number-of-items-btn">
              <span class="number-of-items-text">43/47</span>
            </div>
          </div>
        </div>
        <!-- Leo sideways (landscape) -->
        <div class="swiper-slide">
          <img src="../assets/leo-landscape.jpg" class="landscape-img" />
          <div class="title-row">
            <a href="../index.html" class="close-btn"
              ><span class="x-line"></span
            ></a>
            <div class="pencil-title-row non-interactive">
              <p class="media-item-title">Leo Williams</p>
            </div>
            <a href="" class="options-btn">
              <span class="dot"></span>
              <span class="dot"></span>
              <span class="dot"></span>
            </a>
          </div>
          <div class="title-row-bottom">
            <div class="number-of-items-btn">
              <span class="number-of-items-text">44/47</span>
            </div>
          </div>
        </div>
        <!-- Youtube Video in Africa in playing mode for mobile (portrait) -->
        <div class="swiper-slide">
          <div class="image-container-for-portraits-desktop">
            <img
              src="../assets/youtube-kenya-iphone-playing.png"
              class="portrait-img youtube-portrait"
            />
          </div>
          <div class="title-row">
            <a href="../index.html" class="close-btn"
              ><span class="x-line"></span
            ></a>
            <div class="pencil-title-row non-interactive">
              <p class="media-item-title">Finding the Wildebeasts on Safari</p>
            </div>
            <a href="" class="options-btn">
              <span class="dot"></span>
              <span class="dot"></span>
              <span class="dot"></span>
            </a>
          </div>
          <div class="title-row-bottom">
            <div class="number-of-items-btn">
              <span class="number-of-items-text">45/47</span>
            </div>
          </div>
        </div>
        <!-- Youtube Video in Africa not in play mode for mobile (landscape) -->
        <div class="swiper-slide">
          <div class="kenya-video-iphone-image-container">
            <img
              src="../assets/youtube-kenya-iphone-not-playing.jpg"
              class="landscape-img youtube-landscape"
            />
            <img
              src="../assets/video_play.png"
              alt="icon"
              class="centered-video_play-icon"
            />
          </div>
          <div class="title-row">
            <a href="../index.html" class="close-btn"
              ><span class="x-line"></span
            ></a>
            <div class="pencil-title-row non-interactive">
              <p class="media-item-title">Finding the Wildebeasts on Safari</p>
            </div>
            <a href="" class="options-btn">
              <span class="dot"></span>
              <span class="dot"></span>
              <span class="dot"></span>
            </a>
          </div>
          <div class="title-row-bottom">
            <div class="number-of-items-btn">
              <span class="number-of-items-text">46/47</span>
            </div>
          </div>
        </div>
        <!-- Pasta with Truffle (landscape) -->
        <div class="swiper-slide">
          <img src="../assets/pasta.jpg" class="landscape-img" />
          <div class="title-row">
            <a href="../index.html" class="close-btn"
              ><span class="x-line"></span
            ></a>
            <div class="pencil-title-row non-interactive">
              <p class="media-item-title">A great pasta dish with truffle</p>
            </div>
            <a href="" class="options-btn">
              <span class="dot"></span>
              <span class="dot"></span>
              <span class="dot"></span>
            </a>
          </div>
          <div class="title-row-bottom">
            <div class="number-of-items-btn">
              <span class="number-of-items-text">47/47</span>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- Custom Left Arrow Button -->
    <button class="left-arrow-btn"></button>
    <!-- Custom Right Arrow Button -->
    <button class="right-arrow-btn"></button>

    <!-- Swiper JS -->
    <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>

    <!-- Initialize Swiper and Button Functionality -->
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        let isTouchActive = false;
        let isTitleRowVisible = true; // Start with title-row visible
        let hasSwipedOnTouch = false; // Flag to track swiping during touch event

        // Initialize Swiper
        const swiper = new Swiper(".mySwiper", {
          navigation: {
            nextEl: null,
            prevEl: null,
          },
          on: {
            slideChange: function () {
              updateArrowStyles();
            },
            reachBeginning: updateArrowStyles,
            reachEnd: updateArrowStyles,
          },
        });

        const leftArrow = document.querySelector(".left-arrow-btn");
        const rightArrow = document.querySelector(".right-arrow-btn");

        // Function to handle arrow click with opacity effect
        function handleArrowClick(button, direction) {
          if (!button.classList.contains("disabled")) {
            button.classList.add("active-opacity");

            // Remove the class after 200ms for the transition effect
            setTimeout(() => {
              button.classList.remove("active-opacity");
            }, 200);

            // Trigger slide navigation directly
            if (direction === "prev" && !swiper.isBeginning) {
              swiper.slidePrev();
            } else if (direction === "next" && !swiper.isEnd) {
              swiper.slideNext();
            }
          }
        }

        // Touch event handlers
        function handleTouchStart(e) {
          e.preventDefault(); // Always prevent default behavior
          if (e.target.classList.contains("disabled")) {
            return;
          }
          isTouchActive = true;
          hasSwipedOnTouch = false; // Reset the swipe flag at the start of touch
        }

        function handleTouchEnd(e, direction) {
          if (!e.target.classList.contains("disabled") && !hasSwipedOnTouch) {
            handleArrowClick(e.target, direction);
          }
          setTimeout(() => {
            isTouchActive = false;
          }, 100);
        }

        // Prevent double navigation (touch + click)
        function handleClick(e, direction) {
          if (!isTouchActive && !e.target.classList.contains("disabled")) {
            e.stopPropagation();
            handleArrowClick(e.target, direction);
          }
        }

        // Attach touchstart and touchend listeners to arrow buttons
        leftArrow.addEventListener("touchstart", handleTouchStart);
        leftArrow.addEventListener("touchend", (e) =>
          handleTouchEnd(e, "prev")
        );
        leftArrow.addEventListener("click", (e) => handleClick(e, "prev"));

        rightArrow.addEventListener("touchstart", handleTouchStart);
        rightArrow.addEventListener("touchend", (e) =>
          handleTouchEnd(e, "next")
        );
        rightArrow.addEventListener("click", (e) => handleClick(e, "next"));

        // Detect swipe to prevent touchend from triggering slide navigation twice
        swiper.on("slidePrevTransitionStart", () => {
          hasSwipedOnTouch = true;
        });

        swiper.on("slideNextTransitionStart", () => {
          hasSwipedOnTouch = true;
        });

        // Function to update arrow styles (for disabling)
        function updateArrowStyles() {
          if (swiper.isBeginning) {
            leftArrow.classList.add("disabled");
            leftArrow.style.opacity = "0.3"; // Lower opacity when disabled
            leftArrow.setAttribute("disabled", true);
          } else {
            leftArrow.classList.remove("disabled");
            leftArrow.style.opacity = "1"; // Full opacity when enabled
            leftArrow.removeAttribute("disabled");
          }

          if (swiper.isEnd) {
            rightArrow.classList.add("disabled");
            rightArrow.style.opacity = "0.3"; // Lower opacity when disabled
            rightArrow.setAttribute("disabled", true);
          } else {
            rightArrow.classList.remove("disabled");
            rightArrow.style.opacity = "1"; // Full opacity when enabled
            rightArrow.removeAttribute("disabled");
          }
        }

        function toggleTitleRow() {
          const titleRows = document.querySelectorAll(".title-row");
          const titleRowBottoms =
            document.querySelectorAll(".title-row-bottom");

          if (isTitleRowVisible) {
            titleRows.forEach((titleRow) =>
              titleRow.classList.add("hidden-title-row")
            );
            titleRowBottoms.forEach((titleRowBottom) =>
              titleRowBottom.classList.add("hidden-title-row")
            );
          } else {
            titleRows.forEach((titleRow) =>
              titleRow.classList.remove("hidden-title-row")
            );
            titleRowBottoms.forEach((titleRowBottom) =>
              titleRowBottom.classList.remove("hidden-title-row")
            );
          }

          isTitleRowVisible = !isTitleRowVisible; // Toggle the visibility state
        }

        // Attach click event listener to toggle title-row, excluding the arrows
        const swiperContainer = document.querySelector(".swiper");
        swiperContainer.addEventListener("click", function (event) {
          if (
            !event.target.closest(".left-arrow-btn") &&
            !event.target.closest(".right-arrow-btn")
          ) {
            toggleTitleRow();
          }
        });

        // Initial call to set arrow styles
        updateArrowStyles();
      });
    </script>
  </body>
</html>
